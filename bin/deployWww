#!/bin/bash

# Build a tarball for the compute server
source $HEXCALC/ops/config.sh

if [ -z $DEPLOY_TARGET_PATH ]; then
    echo "Exited, the env var, DEPLOY_TARGET_PATH, must be defined"
    echo "Do you want to run installWww instead?"
    exit 1
fi

echo tarring up the install
FILE=$HEXCALC/ops/compute.tgz
cd $HEXCALC
tar -czf $FILE \
    bin \
    build \
    calc \
    ops/configExamples \
    standalone \
    tests \
    www

# scp to a gateway of the VPN.
scp $FILE $DEPLOY_TARGET_PATH
echo if the scp timed out, do:
echo "scp $FILE $DEPLOY_TARGET_PATH"
